<html>

<head>
    <?php include('includes/head.php'); ?>
        <style>
        .dataTables_wrapper {
            width: 100%;
            overflow: auto;
        }
        </style>
</head>

<body>
    <?php include 'includes/header.php'; ?>
        <div class="page-container">
            <!-- BEGIN PAGE HEAD -->
            <div class="page-head">
                <div class="<?php echo $layoutClass ?>">
                    <!-- BEGIN PAGE TITLE -->
                    <div class="page-title">
                        <h1><?php echo $this->lang->line('menu_clientes'); ?></h1>
                    </div>
                    <!-- END PAGE TITLE -->
                </div>
                <div class="table_loading"></div>
                <div class="page-content">
                    <!-- BEGIN PAGE CONTENT INNER -->
                    <div class="<?php echo $layoutClass ?>">
                        <div class="portlet light">
                            <div class="portlet-body">
                                <div class="col-md-12">
                                    <a href="<?php echo base_url() ?>clientes" class="btn btn-success pull-right">&times;</a>
                                </div>
                                <div class="col-md-3">
                                    <!-- BEGIN EXAMPLE TABLE PORTLET-->
                                    <div class="panel panel-success">
                                        <div class="panel-heading">General</div>
                                        <div class="panel-body no-padding-all">
                                            <ul class="sidebar_tabs" role="tablist">
                                                <li role="presentation" class="active"><a href="#datos-comerciales" aria-controls="Datos_Personales" role="tab" data-toggle="tab"><?php echo $this->lang->line('Datos_Personales'); ?></a></li>
                                                <li><a href="#details" aria-controls="fcturation" role="tab" data-toggle="tab"><?php echo $this->lang->line('details'); ?></a></li>
                                                <li><a href="#personalized_fields" aria-controls="empleados" role="tab" data-toggle="tab"><?php echo $this->lang->line('personalized_fields'); ?></a></li>
                                                <li><a href="#documentos" aria-controls="documentos" role="tab" data-toggle="tab"><?php echo $this->lang->line('clientes_documentos'); ?></a></li>
                                                <li><a href="#follow_up" aria-controls="seguimiento" role="tab" data-toggle="tab"><?php echo $this->lang->line('follow_up'); ?></a></li>
												<li><a href="#plantillas" aria-controls="seguimiento" role="tab" data-toggle="tab"><?php echo $this->lang->line('template'); ?></a></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <!-- END EXAMPLE TABLE PORTLET-->
                                </div>
                                <div class="col-md-9">
                                    <div class="tab-content">
                                        <div role="tabpanel" class="tab-pane active" id="datos-comerciales">
                                            <form class="update_datos_comerciales_form">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('form_ccodcli'); ?>
                                                                <input type="text" class="form-control" name="numpresupuesto" disabled value="<?php echo $content[0]->NumPresupuesto; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('first_name') ?>
                                                                <input type="text" class="form-control" readonly name="sNombre" value="<?php echo $content[0]->sNombre; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('sur_name') ?>
                                                                <input type="text" class="form-control" readonly name="sApellidos" value="<?php echo $content[0]->sApellidos; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('full_name') ?>
                                                                <input type="text" class="form-control" name="" value="<?php echo $content[0]->sNombre . ' ' . $content[0]->sApellidos; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('city') ?>
                                                                <input type="text" class="form-control" name="Poblacion" value="<?php echo $content[0]->Poblacion; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('province') ?>
                                                                <input type="text" class="form-control" name="Provincia" value="<?php echo $content[0]->Provincia; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('adress') ?>
                                                                <textarea type="text" class="form-control" name="domicilio" style="min-height:100px;">
                                                                    <?php echo $content[0]->domicilio; ?>
                                                                </textarea>
                                                                <!--<input type="text" class="form-control" name="domicilio" value="<?php // echo  $content[0]->domicilio;  ?>" />-->
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-5">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('birthday') ?>
                                                                <input type="text" class="form-control datepicker" name="Nacimiento"  value="<?php echo  ($lang=="english")?Date('m/d/Y',strtotime($content[0]->Nacimiento)):Date('d/m/Y',strtotime($content[0]->Nacimiento)); ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('country') ?>
                                                                <input type="text" class="form-control" name="pais" value="<?php echo $content[0]->pais; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('sex') ?>
                                                                <select name="idsexo">
                                                                    <option value="1" <?php if ($content[0]->idsexo == 1) { ?>selected
                                                                        <?php } ?>>
                                                                            <?php echo $this->lang->line('male') ?>
                                                                    </option>
                                                                    <option value="2" <?php if ($content[0]->idsexo == 2) { ?>selected
                                                                        <?php } ?>>
                                                                            <?php echo $this->lang->line('female') ?>
                                                                    </option>
                                                                </select>
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('phone1') ?>
                                                                <input type="text" class="form-control" name="Telefono" value="<?php echo $content[0]->Telefono; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('phone2') ?>
                                                                <input type="text" class="form-control" name="Telefono2" value="<?php echo $content[0]->Telefono2; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('mobile') ?>
                                                                <input type="text" class="form-control" name="Movil" value="<?php echo $content[0]->Movil; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('passport') ?>
                                                                <input type="text" class="form-control" name="CDNICIF" value="<?php echo $content[0]->CDNICIF; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('email1') ?>
                                                                <input type="text" class="form-control" name="email" value="<?php echo $content[0]->email; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('email2') ?>
                                                                <input type="text" class="form-control" name="email2" value="<?php echo $content[0]->email2; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('fax') ?>
                                                                <input type="email" class="form-control" name="Fax" value="<?php echo $content[0]->Fax; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('IBAN') ?>
                                                                <input type="text" class="form-control" name="iban" value="<?php echo $content[0]->iban; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-2">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('bank') ?>
                                                                <input type="text" class="form-control" name="cc1" value="<?php echo $content[0]->cc1; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-2">
                                                    <div class="form-group">
                                                        <label>
                                                            <input type="text" class="form-control" name="cc2" value="<?php echo $content[0]->cc2; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-1">
                                                    <div class="form-group">
                                                        <label>
                                                            <input type="text" class="form-control" name="cc3" value="<?php echo $content[0]->cc3; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label>
                                                            <input type="text" class="form-control" name="cc4" value="<?php echo $content[0]->cc4; ?>" />
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-12 company_select">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('comp_id') ?>
                                                                <input readonly type="text" class="form-control" name="facturara" value="<?php echo $content[0]->facturara; ?>" />
                                                        </label>
                                                    </div>
                                                    <a href="javascript:;" class="select_company contactos_btn btn-success "><i class="fa fa-edit"></i></a><span class="company_name"><?php echo isset($content[0]->CnomCli)?$content[0]->CnomCli:""; ?></span>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="pull-right">
                                                        <button class="btn btn-success " type="submit">
                                                            <?php echo $this->lang->line('clientes_updateBtn'); ?>
                                                        </button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                        <div role="tabpanel" class="tab-pane" id="details">
                                            <form class="fcturation_form">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <?php echo $this->lang->line('Middle_Catchment'); ?>
                                                            <div class="input-group">
                                                                <input type="text" class="form-control" name="medio" value="<?php echo $content[0]->IdMedio; ?>" readonly />
                                                                <span class="input-group-addon">
                                                                     <i class="fa fa-crosshairs IdMedio"></i>
                                                                </span>
                                                                <input id="mediodesc" type="text" class="form-control" readonly  value="<?php echo $content[0]->Descripcion; ?>" />
                                                            </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <?php echo $this->lang->line('campaign'); ?>
                                                            <div class="input-group">
                                                                <input type="text" class="form-control" name="Campaña" value="<?php echo $content[0]->IdCampaña; ?>" readonly />
                                                                <span class="input-group-addon">
                                                                     <i class="fa fa-crosshairs campaign"></i>
                                                                </span>
                                                                <input id="campdesc" type="text" class="form-control" readonly value="<?php echo $content[0]->Des; ?>" />
                                                            </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <?php echo $this->lang->line('Descripcion'); ?>
                                                            <textarea class="form-control" name="Descripcion"><?php echo $content[0]->pdes; ?></textarea>
                                                    </div>
                                                </div>
                                            <div class="col-md-12">
                                                <h3>Detalle De La Solicitud</h3>
                                                <div class="lst_sol_sol">
                                                    <table class="lst_sol_solTable  table  table-striped table-hover table-bordered"></table>
                                                </div>
                                            </div>
                                            <div class="col-md-12 mt10">
                                                    <div class="col-md-12">
                                                        <div class="pull-right">
                                                            <button class="btn btn-success">Save</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                        <div role="tabpanel" class="tab-pane" id="personalized_fields">
                                            <form method="post" action="<?php echo base_url('leads/updateinfo')?>">
                                                <input type="hidden" value="<?php echo $content[0]->NumPresupuesto;?>" name="id">
                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('Asesor') ?>
                                                                <textarea type="text" class="form-control" name="Asesor" style="min-height:100px;">
                                                                    <?php if(isset( $personal_fields[0]->Asesor)){echo $personal_fields[0]->Asesor; }?>
                                                                </textarea>
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>
                                                            <?php echo $this->lang->line('comentarios') ?>
                                                                <textarea type="text" class="form-control" name="comentarios" style="min-height:100px;">
                                                                    <?php if(isset( $personal_fields[0]->Asesor)){ echo $personal_fields[0]->comentarios; }?>
                                                                </textarea>
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="pull-right">
                                                        <button class="btn btn-success " type="submit">
                                                            <?php echo $this->lang->line('clientes_updateBtn'); ?>
                                                        </button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                        <div role="tabpanel" class="tab-pane" id="documentos">
                                                        <div id="myModal" class="modal fade" role="dialog">
 <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Upload Document</h4>
      </div>
      <form id="DocumentUp" method="POST" enctype="multipart/form-data">
      <div class="modal-body">
      <div class="file_name">
            <input placeholder="<?php echo $this->lang->line('fileTitle'); ?>" type="text" name="nombre" required class="filenombre"/>
        </div>
        <div class="file_up">
            <span class="btn btn-default btn-file">
                Browse <input required class="documentin" type="file" name="document[]" />
            </span>
            
        </div>
        <div class="msgblock"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="submit" class="btn btn-primary">Upload</button>
      </div>
      </form>
    </div>
  </div>
                                                        </div>
                                            <div class="">
                                                <table class="documentos table   table-striped table-hover table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <td>
                                                                <?php echo $this->lang->line('actions'); ?>
                                                            </td>
                                                            <td>
                                                                <?php echo $this->lang->line('clientes_document_date'); ?>
                                                            </td>
                                                            <td>
                                                                <?php echo $this->lang->line('clientes_document_name'); ?>
                                                            </td>
                                                            <td>
                                                                <?php echo $this->lang->line('clientes_document_visible'); ?>
                                                            </td>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="table_body_documentos">
                                                    </tbody>
                                                </table>
                                            </div>
                                            <!--                      
                                            <!--TODO area fo qasim END-->
                                        </div>
                                        <div role="tabpanel" class="tab-pane" id="follow_up">
                                            <div class="modal fade in" id="add_seguimiento" style="z-index:9999999999;" role="dialog" aria-labelledby="myModalLabel">
                                                <form>
                                                    <div class="modal-dialog" role="document">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                                                <h4 class="modal-title" id="myModalLabel"><?php echo $this->lang->line('clientes_addSeguimiento'); ?></h4>
                                                            </div>
                                                            <div class="modal-body">
                                                                <div class="form-group">
                                                                    <label>
                                                                        <?php echo $this->lang->line('clientes_followup_titulo'); ?>
                                                                    </label>
                                                                    <input type="text" class="form-control" required name="titulo" />
                                                                </div>
                                                                <div class="form-group">
                                                                    <label>
                                                                        <?php echo $this->lang->line('clientes_followup_fecha'); ?>
                                                                    </label>
                                                                    <input type="text" class="form-control datepicker" required name="fecha" />
                                                                </div>
                                                                <div class="form-group">
                                                                    <label>
                                                                        <?php echo $this->lang->line('clientes_followup_usuario'); ?>
                                                                    </label>
                                                                    <div style="text-transform:uppercase">
                                                                        <?php
                                                                            $userData=$this->session->userdata('userData');
                                                                            echo $usuario=$userData[0]->USUARIO;
                                                                      ?>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label>
                                                                        <?php echo $this->lang->line('clientes_followup_comentario'); ?>
                                                                    </label>
                                                                    <textarea class="form-control" required name="comentarios"></textarea>
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer">
                                                                <button type="button" class="btn btn-default" data-dismiss="modal">
                                                                    <?php echo $this->lang->line('button_modalClose'); ?>
                                                                </button>
                                                                <button type="submit" class="btn btn-primary">
                                                                    <?php echo $this->lang->line('button_saveChanges'); ?>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="modal fade in" id="edit_seguimiento" style="z-index:9999999999;" role="dialog" aria-labelledby="myModalLabel">
                                                <form>
                                                    <div class="modal-dialog" role="document">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                                                <h4 class="modal-title" id="myModalLabel"><?php echo $this->lang->line('clientes_editrecord'); ?></h4>
                                                            </div>
                                                            <div class="modal-body">
                                                                <div class="form-group">
                                                                    <label>
                                                                        <?php echo $this->lang->line('clientes_followup_titulo'); ?>
                                                                    </label>
                                                                    <input type="text" class="form-control" required name="titulo" />
                                                                </div>
                                                                <div class="form-group">
                                                                    <label>
                                                                        <?php echo $this->lang->line('clientes_followup_fecha'); ?>
                                                                    </label>
                                                                    <input type="text" class="form-control datepicker" required name="fecha" />
                                                                </div>
                                                                <div class="form-group">
                                                                    <label>
                                                                        <?php echo $this->lang->line('clientes_followup_usuario'); ?>
                                                                    </label>
                                                                    <div style="text-transform:uppercase">
                                                                        <?php
                                                                            $userData=$this->session->userdata('userData');
                                                                            echo $usuario=$userData[0]->USUARIO;
                                                                      ?>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label>
                                                                        <?php echo $this->lang->line('clientes_followup_comentario'); ?>
                                                                    </label>
                                                                    <textarea class="form-control" required name="comentarios"></textarea>
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer">
                                                                <button type="button" class="btn btn-default" data-dismiss="modal">
                                                                    <?php echo $this->lang->line('button_modalClose'); ?>
                                                                </button>
                                                                <button type="submit" class="btn btn-primary">
                                                                    <?php echo $this->lang->line('button_saveChanges'); ?>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                            <!-- Modal -->
                                            <form id="add_adicionales">
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-3">
                                                        <?php echo $this->lang->line('date_fatch'); ?>
                                                    </div>
                                                    <div class="col-md-9">
                                                        <input type="text" class="form-control datepicker" name="FechaPresupuesto" value=" <?php echo sizeof($content) == 0 ? '' : date('Y-m-d', strtotime($content[0]->FechaPresupuesto)); ?>" />
                                                    </div>
                                                </div>
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-3">
                                                        <?php echo $this->lang->line('country'); ?>
                                                    </div>
                                                    <div class="col-md-9">
                                                        <select class="form-control" name="areaacademica">
                                                            <?php
                                                            foreach ($countries as $c) {
                                                                $selected = sizeof($content) && $content[0]->idestado == $c->id ? 'selected' : '';
                                                                echo '<option value="' . $c->id . '"  ' . $selected . ' >' . $c->valor . '</option>';
                                                            }
                                                            ?>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-3">
                                                        <?php echo $this->lang->line('Priority'); ?>
                                                    </div>
                                                    <div class="col-md-9">
                                                        <select class="form-control" name="priority">
                                                            <option value="<?php echo $this->lang->line('Normal'); ?>">
                                                                <?php echo $this->lang->line('Normal'); ?>
                                                            </option>
                                                            <option value="<?php echo $this->lang->line('High'); ?>">
                                                                <?php echo $this->lang->line('High'); ?>
                                                            </option>
                                                            <option value="<?php echo $this->lang->line('Very_High'); ?>">
                                                                <?php echo $this->lang->line('Very_High'); ?>
                                                            </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-3">
                                                        <?php echo $this->lang->line('adicionales_comentarios'); ?>
                                                    </div>
                                                    <div class="col-md-9">
                                                        <textarea type="text" class="form-control " name="comments">
                                                            <?php echo sizeof($Adicionales) == 0 ? '' : $Adicionales[0]->comments; ?>
                                                        </textarea>
                                                    </div>
                                                </div>
                                            <table class="Seguimiento_table table  table-striped table-hover table-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>
                                                            <?php echo $this->lang->line('clientes_followup_id'); ?>
                                                        </th>
                                                        <th>
                                                            <?php echo $this->lang->line('clientes_followup_fecha'); ?>
                                                        </th>
                                                        <th>
                                                            <?php echo $this->lang->line('clientes_followup_titulo'); ?>
                                                        </th>
                                                        <th>
                                                            <?php echo $this->lang->line('clientes_followup_comentario'); ?>
                                                        </th>
                                                        <th>
                                                            <?php echo $this->lang->line('clientes_followup_actions'); ?>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <?php
                                                foreach ($Seguimiento as $SeguimientoItem) {
                                                    ?>
                                                        <tr>
                                                            <td>
                                                                <?php echo $SeguimientoItem->id; ?>
                                                            </td>
                                                            <td>
                                                            <?php echo  ($lang=="english")?Date('m/d/Y',strtotime($SeguimientoItem->fecha)):Date('d/m/Y',strtotime($SeguimientoItem->fecha)); ?>
                                                            </td>
                                                            <td>
                                                                <?php echo $SeguimientoItem->titulo; ?>
                                                            </td>
                                                            <td>
                                                                <?php echo $SeguimientoItem->comentarios; ?>
                                                            </td>
                                                            <td>
                                                                <button class="btn btn-success seguimiento_edit" data-id="<?php echo $SeguimientoItem->id; ?>"><i class="fa fa-edit "></i></button>
                                                                <button class="btn btn-danger seguimiento_delete" data-id="<?php echo $SeguimientoItem->id; ?>"><i class="fa fa-trash "></i></button>
                                                            </td>
                                                        </tr>
                                                        <?php
                                                }
                                                 ?>
                                                </tbody>
                                            </table>
                                            <div class="col-md-12 mt10">
                                                    <div class="col-md-12">
                                                        <div class="pull-right">
                                                            <button class="btn btn-success adicionales">Save</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
										<div role="tabpanel" class="tab-pane" id="plantillas">
											<form id="template-form" action="" method="post">
												<div class="col-md-12 form-group">
													<div class="col-md-3">
														Documentos</div>
													<div class="col-md-9">
													<?php echo form_dropdown('nombre', $category,''); ?>
													</div>
												</div>
												<div class="col-md-12 form-group">
													<br>
												<div class="col-md-3">
														Documento</div>
												</div>
												<div class="col-md-12 form-group">
													<div id="wysihtml5-toolbar" style="display: none;">
													  <a data-wysihtml5-command="bold">bold</a>
													  <a data-wysihtml5-command="italic">italic</a>
													  <a data-wysihtml5-command="underline">italic</a>

													  <!-- Some wysihtml5 commands require extra parameters -->
													  
													 <a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='div' tabindex='-1'>Normal</a>
													<a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h1' tabindex='-1'>h1</a>
													<a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h2' tabindex='-1'>h2</a>
													<a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h3' tabindex='-1'>h3</a>
													<a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h4'>h4</a>
													<a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h5'>h5</a>
													<a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h6'>h6</a>
													
													<a  data-wysihtml5-command='insertUnorderedList' title='unordered' ><i class='glyphicon glyphicon-list'></i></a>
													<a  data-wysihtml5-command='insertOrderedList' title='ordered' ><i class='glyphicon glyphicon-th-list'></i></a>
													<a  data-wysihtml5-command='Outdent' title='outdent' ><i class='glyphicon glyphicon-indent-right'></i></a>
													<a  data-wysihtml5-command='Indent' title='indent' ><i class='glyphicon glyphicon-indent-left'></i></a>
																						
													

													  <!-- Some wysihtml5 commands like 'createLink' require extra paramaters specified by the user (eg. href) -->
													  <a data-wysihtml5-command="createLink">insert link</a>
													  <div data-wysihtml5-dialog="createLink" style="display: none;">
														<label>
														  Link:
														  <input data-wysihtml5-dialog-field="href" value="http://" class="text">
														</label>
														<a data-wysihtml5-dialog-action="save">OK</a> <a data-wysihtml5-dialog-action="cancel">Cancel</a>
													  </div>
														<a data-wysihtml5-action="change_view" href="javascript:;" unselectable="on">change</a>
													</div>
												
												
													<textarea id="wysihtml5-textarea" name="webDocumento" rows="8" cols="100" placeholder="Enter your text ..." autofocus></textarea>
												</div>
												<div class="col-md-12">
                                                    <div class="pull-right">
                                                        <button id="print" class="btn btn-success">
                                                            Print                                                        </button>
                                                    </div>
                                                </div>
											</form>
										</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="contactos_linkpopup">
                <div class="close_me_over">
                    &times;
                </div>
                <table class="clientes table  table-striped table-hover table-bordered ">
                </table>
            </div>
            <div class="alumnos_linkpopup">
                <div class="close_me_over">
                    &times;
                </div>
                <table class="alumnos table  table-striped table-hover table-bordered ">
                </table>
            </div>
            <div class="Medios_linkpopup">
                <div class="close_me_over">
                    &times;
                </div>
                <table class="Medios table  table-striped table-hover table-bordered ">
                </table>
            </div>
            <div class="campaign_linkpopup">
                <div class="close_me_over">
                    &times;
                </div>
                <table class="campaignTable table  table-striped table-hover table-bordered ">
                </table>
            </div>
            <div class="sel_cursos_linkpopup">
                <div class="close_me_over">
                    &times;
                </div>
                <table class="sel_cursos table  table-striped table-hover table-bordered ">
                </table>
                <div class="col-md-12 mtb10">
					<div class="col-md-12">
					<div class="pull-left">
					<button class="btn btn-success selectall">Select All</button>
					</div>
					<div class="pull-right">
					<button class="btn btn-success savecursos">Save</button>
					</div>
					</div>
				</div>
            </div>
            <div class=""></div>
            <?php include 'includes/footer.php'; ?>
                <script type="text/javascript">
                Metronic.init(); // init metronic core componets
                Layout.init(); // init layout
                app.header.init();
                var hash = window.location.hash;
                $('a[href="' + hash + '"]').tab('show');
                $('.select_company').on('click',function(r){
                	$('.contactos_linkpopup').show();
                    var body = $("html, body");
                    body.stop().animate({
                        scrollTop: 0
                    }, '500', 'swing', function() {
                        // alert("Finished animating");
                    });
                    $('.contactos_linkpopup').find('table tr').find('.select').on('click', function(e) {
                        var row = $(this).parents('tr'),
                            table = $('.contactos_linkpopup').find('table').data('table');
                        rowData = table.fnGetData(row);
                        console.log(rowData);
                        $('input[name="facturara"]').val(rowData.id);
                        $('.company_name').text(rowData["<?php echo $this->lang->line('colcompanyname');?>"]);
                        $('.contactos_linkpopup').hide();
                        body.stop().animate({
                            scrollTop: $('input[name="facturara"]').offset().top
                        }, '500', 'swing', function() {
                            // alert("Finished animating");
                        });
                    });
                });
                
                $('.sidebar_tabs li a').click(function(event) {

                    window.location.hash = this.hash;
                    // $($(this).attr('href')).fadeIn('slow');
                });
                $('.close_me_over').on('click', function(e) {
                    $(this).parent().hide();
                });
                $('form#add_adicionales .adicionales').on('click', function(e) {
                    e.preventDefault();
                    var formData = $('form#add_adicionales').serialize();
                    url = <?php echo sizeof($Adicionales) ?> == 0 ? base_url + '/leads/Adicionales_add/' + clienteId : base_url + '/leads/Adicionales_update/' + clienteId
                    $.ajax({
                        url: url,
                        method: 'post',
                        data: formData,
                        success: function(response) {
                            location.reload();
                        }
                    });
                });
                var clienteId = <?php echo $content[0]->NumPresupuesto; ?>;


                // $('.empleados_table').dataTable();
                // $('.contabilidad').dataTable();
                // $('.HistoricFees').dataTable();
                // $('.Filiales').dataTable();
                // var table = $('.Seguimiento_table').dataTable();
                var table = $('.empleados_table').dataTable({
                    "sDom": '<"top"Bif>r<"ze_wrapper"t> <"bottom"lp><"clear">',
                    "language": {
                        "url": base_url + "app/lang/" + lang + '.json'
                    },
                    buttons: [
                        'copy', 'csv', 'pdf', 'excel', 'print'
                    ],
                    paging: true,
                    "columnDefs": [{
                        "targets": [0],
                        "visible": false
                    }],
                    drawCallback: function() {
                        var api = this.api(),
                            mytable = this;
                        // $(mytable).find('tr').find('button.empleados_link').on('click', function() {
                        //     var rowData = api.row($(this).parents('tr')).data(),
                        //         rowIndex = api.row($(this)).index();
                        //     app.loadajax(base_url + 'tables/specific', 'GET', {
                        //         tableName: rowData.table_name
                        //     }, _dtRecords.processSpecifictable);
                        // });
                    }
                });
                $('.empleados_table').data('table', table);
                var table2 = $('.contabilidad').dataTable({
                    "sDom": '<"top"Bif>r<"ze_wrapper"t> <"bottom"lp><"clear">',
                    "language": {
                        "url": base_url + "app/lang/" + lang + '.json'
                    },
                    buttons: [
                        'copy', 'csv', 'pdf', 'excel', 'print'
                    ],
                    paging: true
                });
                $('.contabilidad').data('table', table2);
                var table3 = $('.HistoricFees').dataTable({
                    "sDom": '<"top"Bif>r<"ze_wrapper"t> <"bottom"lp><"clear">',
                    "language": {
                        "url": base_url + "app/lang/" + lang + '.json'
                    },
                    buttons: [
                        'copy', 'csv', 'pdf', 'excel', 'print'
                    ],
                    paging: true
                });
                $('.HistoricFees').data('table', table3);
                var table4 = $('.Filiales').dataTable({
                    "sDom": '<"top"Bif>r<"ze_wrapper"t> <"bottom"lp><"clear">',
                    "language": {
                        "url": base_url + "app/lang/" + lang + '.json'
                    },
                    buttons: [
                        'copy', 'csv', 'pdf', 'excel', 'print'
                    ],
                    paging: true
                });
                $('.Filiales').data('table', table4);

                var table5 = $('.Seguimiento_table').dataTable({
                	"sDom": "<'table_feature_top' <'exports_option col-md-6 no-padding'<'col-md-12 no-padding'B>><'col-md-6 exports_option no-padding'<'col-md-8 dataTables_filter no-padding'f><'col-md-4 no-padding seguimientoholder'>>><<'col-md-12 col-xs-12'ri>><'ze_wrapper't><<'col-md-6 col-xs-12'l><'col-md-6 col-xs-12'p>>",
                    "language": {
                        "url": base_url + "app/lang/" + lang + '.json'
                    },
                    buttons: [
                        'copy', 'csv', 'pdf', 'excel', 'print'
                    ],
                    "bAutoWidth": false,
                    paging: true,
                    "columnDefs": [{
                        "targets": [0],
                        "visible": false
                    }],
                    fnRowCallback: function(nRow, aData) {
                        $.each(nRow.cells, function(i, d) {
                            d.noWrap = true;
                        });
                        return nRow;
                    },
                    fnInitComplete: function(){
                    	$.each($('.Seguimiento_table thead tr th'),function(a,b){
                    		if(a==3){
                    			$(this).css({
                                    'width':30+'px'
                                    });
                    		}
                    	});
                    	var seguimiento = '<button class="btn btn-success add_seguimiento"><?php echo $this->lang->line('clientes_addSeguimiento'); ?></button>';
	                        $('.seguimientoholder').html(seguimiento);
	                        $('.add_seguimiento').off().on('click', function(e) {
		                        e.preventDefault();
	                            var modal = $('#add_seguimiento'),
	                                form = modal.find('form');
	                            form.off().on('submit', function(e) {
	                                e.preventDefault();
	                                var formData = $(this).serialize();
	                                //console.log(formData);
	                                $.ajax({
	                                    url: base_url + 'leads/Seguimiento/' + clienteId,
	                                    method: 'post',
	                                    data: formData,
	                                    success: function(response) {
	                                        //console.log(response);
	                                        location.reload();
	                                    }
	                                })
	                            });
	                            modal.modal();
	                        });
                        }
                });
                $('.Seguimiento_table').data('table', table5);

                $('.update_datos_comerciales_form').on('submit', function(e) {
                    e.preventDefault();
                    var formData = $(this).serialize();
                    //console.log(formData);
                    $.ajax({
                        url: base_url + '/leads/datos_comerciales/' + clienteId,
                        method: 'post',
                        data: formData,
                        success: function(response) {
                            location.reload();

                            //console.log(response);
                        }
                    })
                });
                $('.fcturation_form').on('submit', function(e) {
                    e.preventDefault();
                    var formData = $(this).serialize();
                    $.ajax({
                        url: base_url + '/leads/datos_fcturation/' + clienteId,
                        method: 'post',
                        data: formData,
                        success: function(response) {
                            location.reload();

                            //console.log(response);
                        }
                    })
                });
                $('.empleados_link').on('click', function(e) {
                    var alumnos_linkpopup = $('.alumnos_linkpopup');
                    alumnos_linkpopup.show()
                    alumnos_linkpopup.find('table tr').find('.select').on('click', function(e) {
                        var row = $(this).parents('tr'),
                            table = alumnos_linkpopup.find('table').data('table');
                        rowData = table.fnGetData(row);
                        //console.log(rowData);
                        var linkFrom = rowData.Id,
                            linkTo = clienteId;
                        $.ajax({
                            url: base_url + 'clientes/empleados/' + clienteId,
                            method: 'post',
                            data: {
                                linkFrom: linkFrom
                            },
                            success: function(response) {
                                alumnos_linkpopup.hide()
                                location.reload();

                                //console.log(response);
                            }
                        });
                    });
                });
                $('.Seguimiento_table').find('tr').find('.seguimiento_edit').off().on('click', function(e) {
                    e.preventDefault();
                    var row = $(this).parents('tr'),
                        table = $('.Seguimiento_table').data('table');
                    rowData = table.fnGetData(row);
                    //console.log(rowData);
                    var edit_seguimiento = $('#edit_seguimiento');
                    edit_seguimiento.find('[name="titulo"]').val(rowData[2]);
                    edit_seguimiento.find('[name="fecha"]').val(rowData[1]);
                    edit_seguimiento.find('[name="comentarios"]').val(rowData[3]);
                    edit_seguimiento.find('form').off().on('submit', function(e) {
                        e.preventDefault();
                        var formData = $(this).serialize();
                        $.ajax({
                            url: base_url + 'leads/Seguimiento_edit/' + rowData[0],
                            method: 'post',
                            data: formData,
                            success: function(response) {
                                location.reload();

                                //console.log(response);
                            }
                        })
                    });
                    edit_seguimiento.modal();
                });

                $('.Seguimiento_table').find('tr').find('.seguimiento_delete').off().on('click', function(e) {
                	e.preventDefault();
                    var row = $(this).parents('tr'),
                        table = $('.Seguimiento_table').data('table');
                    rowData = table.fnGetData(row);
                    yesDelete = confirm(language.confirmDelete);
                    if (yesDelete) {
                        $.ajax({
                            url: base_url + 'leads/Seguimiento/' + rowData[0],
                            method: 'DELETE',
                            success: function(response) {
                                if (response) {
                                    location.reload();

                                    //console.log(response);
                                }
                            }
                        });
                    }
                });

                $('.Filiales').find('tr').find('.delete').off().on('click', function(e) {
                    var row = $(this).parents('tr'),
                        table = $('.Filiales').data('table');
                    rowData = table.fnGetData(row);
                    yesDelete = confirm(language.confirmDelete);
                    if (yesDelete) {
                        $.ajax({
                            url: base_url + 'clientes/Filiales/' + rowData[1],
                            method: 'DELETE',
                            success: function(response) {
                                if (response) {
                                    location.reload();
                                    //console.log(response);
                                }
                            }
                        });
                    }
                });
                $('.empleados_table').find('tr').find('.empleados_unlink').off().on('click', function(e) {
                    var row = $(this).parents('tr'),
                        table = $('.empleados_table').data('table');
                    rowData = table.fnGetData(row);
                    //console.log(rowData);
                    yesDelete = confirm(language.confirmDelete);
                    if (yesDelete) {
                        $.ajax({
                            url: base_url + 'clientes/empleados/' + rowData[0],
                            method: 'DELETE',
                            success: function(response) {
                                if (response) {
                                    location.reload();
                                    //console.log(response);
                                }
                            }
                        });
                    }
                });

                //console.log(JSON.parse('<?php echo json_encode($alumnos); ?>'));
                $('.Filiales_add').on('click', function(e) {
                    var contactos_linkpopup = $('.contactos_linkpopup');
                    contactos_linkpopup.show();
                    contactos_linkpopup.find('table tr').find('.select').off().on('click', function(e) {
                        var row = $(this).parents('tr'),
                            table = contactos_linkpopup.find('table').data('table');
                        rowData = table.fnGetData(row);
                        var linkFrom = clienteId,
                            linkTo = rowData.CCODCLI;
                        $.ajax({
                            url: base_url + 'clientes/Filiales/' + clienteId,
                            method: 'POST',
                            data: {
                                linkFrom: linkFrom,
                                linkTo: linkTo
                            },
                            success: function(response) {
                                if (response) {
                                    contactos_linkpopup.hide();
                                    location.reload();
                                    //console.log(response);
                                }
                            }
                        });
                    });
                });
                var clientesData = [];
                var tableContents = JSON.parse('<?php echo json_encode($clientes); ?>');
                //console.log(tableContents);
                clientesData['content'] = tableContents.filter(function(d) {
                    return d.CCODCLI != clienteId
                });
                clientesData['dataKeys'] = JSON.parse('<?php echo json_encode($dataKeys); ?>');
                if (clientesData) {
                    //console.log(clientesData['content']);
                    var ContactosTable = $('.clientes');
                    var responseData = clientesData,
                        dbcolumns = [],
                        dbdata = [],
                        detailScreen = $('.specific_table'),
                        idNumaric = 0,
                        primary_key = '';
                    // app.generateContactosAddForm(responseData.lang);
                    dbcolumns.push({
                        data: null,
                        defaultContent: '<a href="javascript:;" class="btn btn-success select">SELECT</a>',
                        className: 'select-checkbox',
                        orderable: false,
                        title: 'Select',
                        editable: false
                    });
                    // return false;
                    $.each(responseData.content, function(index, row) {
                        var keys = Object.keys(row),
                            newRow = {};
                        $.each(keys, function(i, k) {
                            newRow[k] = row[k];
                            if (index == 0) {
                                dbcolumns.push({
                                    title: decode_utf8(k),
                                    data: k,
                                    editable: true,
                                    render: function(value, funn, fullRow) {
                                        if (k == 'idsexo') {
                                            return value == 1 ? language.contactos_keymale : language.contactos_keyfemale;
                                        } else {
                                            return value;
                                        }
                                    }
                                });
                            }
                        });
                        dbdata.push(newRow);
                    });
                    var table = ContactosTable.dataTable({
                        data: dbdata,
                        columns: dbcolumns,
                        "sDom": '<"top"if>r<"ze_wrapper"t> <"bottom"lp><"clear">',
                        "language": {
                            "url": base_url + "app/lang/" + lang + '.json'
                        },
                        paging: true,
                        drawCallback: function() {
                            var api = this.api(),
                                mytable = this;
                            $(mytable).find('tr').find('button.show_table').on('click', function() {
                                var rowData = api.row($(this).parents('tr')).data(),
                                    rowIndex = api.row($(this)).index();
                                app.loadajax(base_url + 'tables/specific', 'GET', {
                                    tableName: rowData.table_name
                                }, _dtRecords.processSpecifictable);
                            });

                        },
                        fnInitComplete: function(){
                        	$.each($('.clientes thead tr th'),function(a,b){
                        		if(a==2){
                        			$(this).css({
                                        'min-width':85+'px'
                                        });
                        		}else if(a==10){
                        			$(this).css({
                                        'min-width':45+'px'
                                        });
                        		}
                        	})
                        }
                    });
                   
                    ContactosTable.data('table', table);
                }

                // alumnos
                //   var clientesData = [];
                var alumnostableContents = JSON.parse('<?php echo json_encode($alumnos); ?>');;
                clientesData['content'] = alumnostableContents;
                if (clientesData) {
                    var alumnosTable = $('.alumnos');
                    var responseData = clientesData,
                        dbcolumns = [],
                        dbdata = [],
                        detailScreen = $('.specific_table'),
                        idNumaric = 0,
                        primary_key = '';
                    // app.generateContactosAddForm(responseData.lang);
                    dbcolumns.push({
                        data: null,
                        defaultContent: '<a href="javascript:;" class="btn btn-success select">SELECT</a>',
                        className: 'select-checkbox',
                        orderable: false,
                        title: 'Select',
                        editable: false
                    });
                    // return false;
                    $.each(responseData.content, function(index, row) {
                        var keys = Object.keys(row),
                            newRow = {};
                        $.each(keys, function(i, k) {
                            newRow[k] = row[k];
                            if (index == 0) {
                                dbcolumns.push({
                                    title: k,
                                    data: k,
                                    editable: true,
                                    render: function(value, funn, fullRow) {
                                        if (k == 'idsexo') {
                                            return value == 1 ? language.contactos_keymale : language.contactos_keyfemale;
                                        } else {
                                            return value;
                                        }
                                    }
                                });
                            }
                        });
                        dbdata.push(newRow);
                    });
                    var table = alumnosTable.dataTable({
                        data: dbdata,
                        columns: dbcolumns,
                        "sDom": '<"top"if>r<"ze_wrapper"t> <"bottom"lp><"clear">',
                        "language": {
                            "url": base_url + "app/lang/" + lang + '.json'
                        },
                        paging: true,
                        "columnDefs": [{
                            "targets": [1],
                            "visible": false
                        }],
                        drawCallback: function() {
                            var api = this.api(),
                                mytable = this;
                            $(mytable).find('tr').find('button.show_table').on('click', function() {
                                var rowData = api.row($(this).parents('tr')).data(),
                                    rowIndex = api.row($(this)).index();
                                app.loadajax(base_url + 'tables/specific', 'GET', {
                                    tableName: rowData.table_name
                                }, _dtRecords.processSpecifictable);
                            });

                        }
                    });
                    alumnosTable.data('table', table);
                }
                // medios  
                //   var clientesData = [];
                var mediosTableContents = JSON.parse('<?php echo json_encode($medios); ?>');
                clientesData['content'] = mediosTableContents;
                if (clientesData) {
                    var mediosTable = $('.medios');
                    var responseData = clientesData,
                        dbcolumns = [],
                        dbdata = [],
                        detailScreen = $('.specific_table'),
                        idNumaric = 0,
                        primary_key = '';
                    // app.generateContactosAddForm(responseData.lang);
                    dbcolumns.push({
                        data: null,
                        defaultContent: '<a href="javascript:;" class="btn btn-success select">SELECT</a>',
                        className: 'select-checkbox',
                        orderable: false,
                        title: 'Select',
                        editable: false
                    });
                    // return false;
                    $.each(responseData.content, function(index, row) {
                        var keys = Object.keys(row),
                            newRow = {};
                        $.each(keys, function(i, k) {
                            newRow[k] = row[k];
                            if (index == 0) {
                                dbcolumns.push({
                                    title: k,
                                    data: k,
                                    editable: true,
                                    render: function(value, funn, fullRow) {
                                        if (k == 'idsexo') {
                                            return value == 1 ? language.contactos_keymale : language.contactos_keyfemale;
                                        } else {
                                            return value;
                                        }
                                    }
                                });
                            }
                        });
                        dbdata.push(newRow);
                    });
                    var table = mediosTable.dataTable({
                        data: dbdata,
                        columns: dbcolumns,
                        "sDom": '<"top"if>r<"ze_wrapper"t> <"bottom"lp><"clear">',
                        "language": {
                            "url": base_url + "app/lang/" + lang + '.json'
                        },
                        paging: true,
                        drawCallback: function() {
                            var api = this.api(),
                                mytable = this;
                            $(mytable).find('tr').find('button.show_table').on('click', function() {
                                var rowData = api.row($(this).parents('tr')).data(),
                                    rowIndex = api.row($(this)).index();
                                app.loadajax(base_url + 'tables/specific', 'GET', {
                                    tableName: rowData.table_name
                                }, _dtRecords.processSpecifictable);
                            });

                        }
                    });
                    mediosTable.data('table', table);
                }

                // campaign  
                var campaignTableContents = JSON.parse('<?php echo json_encode($campaign); ?>');
                clientesData['content'] = campaignTableContents;
                if (clientesData) {
                    var campaignTable = $('.campaignTable');
                    var responseData = clientesData,
                        dbcolumns = [],
                        dbdata = [],
                        detailScreen = $('.specific_table'),
                        idNumaric = 0,
                        primary_key = '';
                    dbcolumns.push({
                        data: null,
                        defaultContent: '<a href="javascript:;" class="btn btn-success select">SELECT</a>',
                        className: 'select-checkbox',
                        orderable: false,
                        title: 'Select',
                        editable: false
                    });
                    // return false;
                    $.each(responseData.content, function(index, row) {
                        var keys = Object.keys(row),
                            newRow = {};
                        $.each(keys, function(i, k) {
                            newRow[k] = row[k];
                            if (index == 0) {
                                dbcolumns.push({
                                    title: k,
                                    data: k,
                                    editable: true,
                                    render: function(value, funn, fullRow) {
                                       return value;
                                    }
                                });
                            }
                        });
                        dbdata.push(newRow);
                    });
                    var table = campaignTable.dataTable({
                        data: dbdata,
                        columns: dbcolumns,
                        "sDom": '<"top"if>r<"ze_wrapper"t> <"bottom"lp><"clear">',
                        "language": {
                            "url": base_url + "app/lang/" + lang + '.json'
                        },
                        paging: true,
                        drawCallback: function() {
                            var api = this.api(),
                                mytable = this;
                            $(mytable).find('tr').find('button.show_table').on('click', function() {
                                var rowData = api.row($(this).parents('tr')).data(),
                                    rowIndex = api.row($(this)).index();
                                app.loadajax(base_url + 'tables/specific', 'GET', {
                                    tableName: rowData.table_name
                                }, _dtRecords.processSpecifictable);
                            });

                        }
                    });
                    campaignTable.data('table', table);
                }
                
                // lst_sol_sol 
                //   var clientesData = [];
                var lst_sol_solContents = JSON.parse('<?php echo json_encode($lst_sol_sol); ?>');
                clientesData['content'] = lst_sol_solContents;
                if (clientesData) {
                    var lst_sol_solTable = $('.lst_sol_solTable');
                    var responseData = clientesData,
                        dbcolumns = [],
                        dbdata = [],
                        detailScreen = $('.specific_table'),
                        idNumaric = 0,
                        primary_key = '';
                    // app.generateContactosAddForm(responseData.lang);
                    dbcolumns.push({
                        data: null,
                        defaultContent: '<a href="javascript:;" class="btn btn-danger lst_sol_sol_delete trash"><i class="fa fa-trash"></i></a>',
                        className: 'select-checkbox',
                        orderable: false,
                        title: 'Select',
                        editable: false
                    });
                    // return false;
                    $.each(responseData.content, function(index, row) {
                        var keys = Object.keys(row),
                            newRow = {};
                        $.each(keys, function(i, k) {
                            newRow[k] = row[k];
                            if (index == 0) {
                                dbcolumns.push({
                                    title: k,
                                    data: k,
                                    editable: true,
                                    render: function(value, funn, fullRow) {
                                        if (k == 'idsexo') {
                                            return value == 1 ? language.contactos_keymale : language.contactos_keyfemale;
                                        } else {
                                            return value;
                                        }
                                    }
                                });
                            }
                        });
                        dbdata.push(newRow);
                    });
                    var table = lst_sol_solTable.dataTable({
                        data: dbdata,
                        columns: dbcolumns,
                        "sDom": '<"top"<"col-md-8 no-padding"if><"col-md-4 no-padding addsubjectholder">>r<"ze_wrapper"t> <"bottom"lp><"clear">',
                        "language": {
                            "url": base_url + "app/lang/" + lang + '.json'
                        },
                        paging: false,
                        info: false,
                        search: false,
                        drawCallback: function() {
                            var api = this.api(),
                                mytable = this;
                            $(mytable).find('tr').find('button.show_table').on('click', function() {
                                var rowData = api.row($(this).parents('tr')).data(),
                                    rowIndex = api.row($(this)).index();
                                app.loadajax(base_url + 'tables/specific', 'GET', {
                                    tableName: rowData.table_name
                                }, _dtRecords.processSpecifictable);
                            });
                            $('.lst_sol_sol_delete').on('click', function(e) {
                                var row = $(this).parents('tr'),
                                    table = $('.lst_sol_solTable').data('table');
                                rowData = table.fnGetData(row);
                                yesDelete = confirm(language.confirmDelete);
                                if (yesDelete) {
                                    $.ajax({
                                        url: base_url + 'leads/deletecourse/' + rowData.id,
                                        method: 'DELETE',
                                        success: function(response) {
                                            if (response) {
                                                location.reload();
                                            }
                                        }
                                    });
                                }
                            });
                        },
                        fnRowCallback: function(nRow, aData) {
                            $.each(nRow.cells, function(i, d) {
                                d.noWrap = true;
                            });
                            return nRow;
                        },
                        fnInitComplete: function(){
                        	var addsubject = '<button class="pull-right btn btn-success addsubject">Add Course</button>';
	                        $('.addsubjectholder').html(addsubject);
	                        $('.addsubject').on('click',function(e){
		                        e.preventDefault();
                            	$(".sel_cursos_linkpopup").show();
                                });
                        	$.each($('.lst_sol_solTable thead tr th'),function(a,b){
                            	if(a==6){
                            		$(this).css({
                                        'min-width':70+'px'
                                        });
                                	}
                        	})
                        }
                    });
                    lst_sol_solTable.data('table', table);
                }


                   // sel_cursos  
                //   var clientesData = [];
                var sel_cursosTableContents = JSON.parse('<?php echo json_encode($sel_cursos); ?>');
                clientesData['content'] = sel_cursosTableContents;
                if (clientesData) {
                    var sel_cursosTable = $('.sel_cursos');
                    var responseData = clientesData,
                        dbcolumns = [],
                        dbdata = [],
                        detailScreen = $('.specific_table'),
                        idNumaric = 0,
                        primary_key = '';
                    // app.generateContactosAddForm(responseData.lang);
                    dbcolumns.push({
                        data: null,
                        defaultContent: '<input type="checkbox" />',
                        className: 'select-checkbox',
                        orderable: false,
                        title: 'Select',
                        editable: false
                    });
                    // return false;
                    $.each(responseData.content, function(index, row) {
                        var keys = Object.keys(row),
                            newRow = {};
                        $.each(keys, function(i, k) {
                            newRow[k] = row[k];
                            if (index == 0) {
                                dbcolumns.push({
                                    title: k,
                                    data: k,
                                    editable: true,
                                    render: function(value, funn, fullRow) {
                                        if (k == 'idsexo') {
                                            return value == 1 ? language.contactos_keymale : language.contactos_keyfemale;
                                        } else {
                                            return value;
                                        }
                                    }
                                });
                            }
                        });
                        dbdata.push(newRow);
                    });
                    var table = sel_cursosTable.dataTable({
                        data: dbdata,
                        columns: dbcolumns,
                        "sDom": '<"top"if<"pull-right" <button class="done">Done</button> >>r<"ze_wrapper"t> <"bottom"lp><"clear">',
                        "language": {
                            "url": base_url + "app/lang/" + lang + '.json'
                        },
                        paging: false,
                        drawCallback: function() {
                            var api = this.api(),
                                mytable = this;
                            $(mytable).find('tr').find('button.show_table').on('click', function() {
                                var rowData = api.row($(this).parents('tr')).data(),
                                    rowIndex = api.row($(this)).index();
                                app.loadajax(base_url + 'tables/specific', 'GET', {
                                    tableName: rowData.table_name
                                }, _dtRecords.processSpecifictable);
                            });

                        }
                    });
                    sel_cursosTable.data('table', table);
                }

                $.ajax({
                    url: base_url + 'Leads_awsrest/documents/' + clienteId,
                    method: 'GET',
                    dataType: 'json',
                    success: function(response) {
                        if (response.status) {
                            var data = response.data;
                            var table6 = $('.documentos').dataTable({
                                data: data,
                                columns: [{
                                    data: null,
                                    defaultContent: '<a href="#" class="btn btn-success editDt"><i class="fa fa-pencil"></i></a>',
                                    className: 'select-checkbox',
                                    orderable: false,
                                    title: language.actions,
                                    editable: false,
                                    render: function(v, funn, full) {
                                        return '<a href="javascript:;" class="btn btn-danger delete_documentos"><i class="fa fa-trash"></i></a>'
                                    }
                                }, {
                                    title: language.clientes_document_date,
                                    data: "fecha"
                                }, {
                                    title: language.clientes_document_name,
                                    data: "nombre",
                                    render: function(value, ee, full) {
                                        return '<a href="' + full.doclink + '" target="_blank" title="'+ full.nombre+'">' + full.nombre + '</a>';
                                    }

                                }, {
                                    title: language.clientes_document_visible,
                                    data: "visible"
                                }],
                                "sDom": "<'table_feature_top' <'exports_option col-md-6 no-padding'<'col-md-12 no-padding'B>><'col-md-6 exports_option no-padding'<'col-md-8 dataTables_filter no-padding'f><'col-md-4 no-padding uploadholder'>>><<'col-md-12 col-xs-12'ri>><'ze_wrapper't><<'col-md-6 col-xs-12'l><'col-md-6 col-xs-12'p>>",
                                "language": {
                                    "url": base_url + "app/lang/" + lang + '.json'
                                },
                                 buttons: [
                                     'copy', 'csv', 'pdf', 'excel', 'print'
                                 ],
                                paging: false,
                                drawCallback: function() {
                                    var api = this.api(),
                                        mytable = this;
                                    $(mytable).find('tr').find('.delete_documentos').on('click', function(e) {
                                        e.preventDefault();
                                        var rowData = api.row($(this).parents('tr')).data(),
                                            rowIndex = api.row($(this)).index(),
                                            index = rowData.doclink.lastIndexOf("/") + 1,
                                            file_name = rowData.doclink.substr(index),
                                            bucket_name = rowData.doclink.split('.')[0].split('//')[1];
                                        app.loadajax(base_url + 'Leads_awsrest/fileDelete', 'post', {
                                            file_name: file_name,
                                            bucket_name: bucket_name,
                                            documentId: rowData.id
                                        }, function(response) {
                                            if (response) {
                                                location.reload();
                                                api.row($(this).parents('tr')).remove();
                                            }
                                        });
                                    });
                                },
                                fnInitComplete: function(){
                                	var upload = '<a data-toggle="modal" data-target="#myModal" class="btn btn-primary add_rcd"  href="javascript:;"><i class="fa fa-plus"></i>' + language.clientes_addDocument + '</a>';
                                	$('.uploadholder').html(upload);
                                }
                            });
                            $('.documentos').data('table', table6);
                        }
                    }

                });

                // // $.get(base_url + 'Leads_awsrest/documents/' + clienteId,
                //     function(data) {
                //         switch (data.status) {
                //             case true:
                //                 {
                //                     data.content.forEach(function(e, i) {
                //                         var tr = document.createElement('tr');
                //                         var td = document.createElement('td');
                //                         $(td).html(e.fecha);
                //                         $(tr).append(td)
                //                         td = document.createElement('td');
                //                         $(td).html(e.nombre);
                //                         $(tr).append(td)
                //                         td = document.createElement('td');
                //                         $(td).html('<a href="' + e.doclink + '" target="_blank">' + e.doclink + '</a>');
                //                         $(tr).append(td);
                //                         td = document.createElement('td');
                //                         $(td).html(e.visible);
                //                         $(tr).append(td);

                //                         $("#table_body_documentos").append(tr);
                //                     });

                //                     var table6 = $('.documentos').dataTable({
                //                         "sDom": '<"top"Bif>r<"ze_wrapper"t> <"bottom"lp><"clear">',
                //                         "language": {
                //                             "url": base_url + "app/lang/" + lang + '.json'
                //                         },
                //                         buttons: [
                //                             'copy', 'csv', 'pdf', 'excel', 'print'
                //                         ],
                //                         paging: true
                //                     });
                //                     $('.documentos').data('table', table6);
                //                     break;
                //                 }
                //             default:
                //                 {

                //                 }
                //         }
                //     }, 'json');



                jQuery(function($) {
                    $(".expirecc").mask("99/9999", {
                        placeholder: "mm/yyyy"
                    });
                    $(".year").mask("9999", {
                        placeholder: "yyyy"
                    });
                });


                $('.IdMedio').on('click', function(e) {
                    $('.Medios_linkpopup').show();
                    var body = $("html, body");
                    body.stop().animate({
                        scrollTop: 0
                    }, '500', 'swing', function() {
                        // alert("Finished animating");
                    });
                    $('.Medios_linkpopup').find('table tr').find('.select').on('click', function(e) {
                        var row = $(this).parents('tr'),
                            table = $('.Medios_linkpopup').find('table').data('table');
                        rowData = table.fnGetData(row);
                        $('input[name="medio"]').val(rowData.IdMedio);
                        $('#mediodesc').val(rowData.Descripcion);

                        $('.company_name').text(rowData["Name of Company"]);
                        $('.Medios_linkpopup').hide();
                        body.stop().animate({
                            scrollTop: $('#mediodesc').offset().top
                        }, '500', 'swing', function() {
                            // alert("Finished animating");
                        });
                    });
                });
               
                $('.campaign').on('click', function(e) {
                	$('.campaign_linkpopup').show();
                    var body = $("html, body");
                    body.stop().animate({
                        scrollTop: 0
                    }, '500', 'swing', function() {
                        // alert("Finished animating");
                    });
                    $('.campaign_linkpopup').find('table tr').find('.select').on('click', function(e) {
                        var row = $(this).parents('tr'),
                            table = $('.campaign_linkpopup').find('table').data('table');
                        rowData = table.fnGetData(row);
                        console.log(rowData);
                        $('input[name="Campaña"]').val(rowData.id);
                        $('#campdesc').val(rowData.description);
                        $('.campaign_linkpopup').hide();
                        body.stop().animate({
                            scrollTop: $('#campdesc').offset().top
                        }, '500', 'swing', function() {
                            // alert("Finished animating");
                        });
                    });
                });
				$('#plantillas select[name="id_cat"]').change(function(){
					var text = $(this).val();
						$.ajax({
									url: base_url + 'leads/documentos/' + text,
									method: 'POST',
									data: {
										text: text
									},
									success: function(response) {
										if (response) {
											var select = $('#plantillas').find('select[name="id"]');
											select.empty();
											var result = JSON.parse(response);
											select.append('<option value="">Select</option>');
											$(result).each(function(i,el){
												select.append(new Option(el.name, el.id, false, false));
											});
										}
									}
								});
				});
				
				$('#plantillas select[name="id"]').change(function(){
					var text = $(this).val();
					$.ajax({
							url: base_url + 'leads/documentodata/' + text,
							method: 'POST',
							data: {
								clienteId: clienteId
							},
							success: function(response) {
								if (response) {
									var modal = $("#plantillas");
									modal.find('.wysihtml5-sandbox, .wysihtml5-toolbar').remove();
									$('#wysihtml5-textarea').show();
									$('#wysihtml5-textarea').val(response);
									editor = new wysihtml5.Editor("wysihtml5-textarea", { // id of textarea element
										  toolbar:      "wysihtml5-toolbar", // id of toolbar element
										  name:                 "wysihtml5-editor",
										  parserRules:  function(html) {
															return html;
														} // defined in parser rules set 
										});
								}
							}
							});
				});
				
$("#print").click(function(e){
		e.preventDefault();
		var iframe = $('.wysihtml5-sandbox')[0]; 
		iframe.contentWindow.focus(); 
		iframe.contentWindow.print();
	});
var selectall = false;
$(".selectall").on('click',function(){
	if(!selectall){
		selectall = true;
		$('table.sel_cursos tbody').find('.select-checkbox input').prop('checked', true);
	}else{
		selectall = false;
		$('table.sel_cursos tbody').find('.select-checkbox input').prop('checked', false);
	}
});
$(".savecursos").on('click',function(){
	ids = $('table.sel_cursos tbody').find('.select-checkbox input:checked');
    idx=[];
    $.each(ids,function(i,input){
    	row = $(this).parents('tr'),
    	table = $('table.sel_cursos').data('table');
        rowData = table.fnGetData(row);
        idx.push(rowData.id);
    });
    $.ajax({
        beforeSend:function(){
        },
        url:base_url+'leads/course_add/'+clienteId,
        type:"POST",
        data:{ids:idx},
        success:function(response){
            console.log(response);
        	location.reload();
		},
		error:function(){
			alert('Got system error');
		},
		complete:function(){
		}
    });
});
$("#DocumentUp").ajaxForm({
	beforeSend: function(){
	$('.msgblock').html('Uploading...');
	},
	url: base_url+'awsrest/upload/leads/'+clienteId,
	uploadProgress: function(ev, position, total, percentComplete){
	},
	dataType:'JSON',
	success: function(data) {
		/*if(data.success==1){
			$("#DocumentUp")[0].reset();
			$('.documentos').dataTable().fnAddData([
			    data.d])
		}*/
		$('.msgblock').html(data.message);
		location.reload();
	},
	error: function(data){
		console.log(data);
	},
	complete: function(){
	}
});
                </script>
        </div>
</body>

</html>
